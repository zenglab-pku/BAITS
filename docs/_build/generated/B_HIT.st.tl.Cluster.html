<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="B_HIT.st.tl.ClusterAutoK" href="B_HIT.st.tl.ClusterAutoK.html" /><link rel="prev" title="B_HIT.st.tl.dbscan_filter" href="B_HIT.st.tl.dbscan_filter.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>B_HIT.st.tl.Cluster - B_HIT</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=366103d0" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">B_HIT</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">B_HIT</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api.html">API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../st.html">st</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of st</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../st_graph.html">Graph</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Graph</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.st.gr.aggregate_neighbors.html">B_HIT.st.gr.aggregate_neighbors</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../st_tools.html">Tools</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="B_HIT.st.tl.kde_filter.html">B_HIT.st.tl.kde_filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.st.tl.dbscan_filter.html">B_HIT.st.tl.dbscan_filter</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">B_HIT.st.tl.Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.st.tl.ClusterAutoK.html">B_HIT.st.tl.ClusterAutoK</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../st_plot.html">Plotting</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Plotting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.st.pl.clustering_results.html">B_HIT.st.pl.clustering_results</a></li>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.st.pl.silhouette_scores.html">B_HIT.st.pl.silhouette_scores</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sVDJ.html">sVDJ</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of sVDJ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../sVDJ_tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.sVDJ.tl.compute_correlation.html">B_HIT.sVDJ.tl.compute_correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.sVDJ.tl.compute_grouped_index.html">B_HIT.sVDJ.tl.compute_grouped_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.sVDJ.tl.compute_richness.html">B_HIT.sVDJ.tl.compute_richness</a></li>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.sVDJ.tl.compute_clone_counts.html">B_HIT.sVDJ.tl.compute_clone_counts</a></li>
<li class="toctree-l4"><a class="reference internal" href="B_HIT.sVDJ.tl.compute_richness.html">B_HIT.sVDJ.tl.compute_richness</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/generated/B_HIT.st.tl.Cluster.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="b-hit-st-tl-cluster">
<h1>B_HIT.st.tl.Cluster<a class="headerlink" href="#b-hit-st-tl-cluster" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">B_HIT.st.tl.</span></span><span class="sig-name descname"><span class="pre">Cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kmeans'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance_regularization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster" title="Link to this definition">¶</a></dt>
<dd><p>Cluster cells or spots based on features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_clusters</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)) – The number of components in the GMM. The dimensionality of each component is automatically inferred from the data.</p></li>
<li><p><strong>covariance_type</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'full'</span></code>)) – The type of covariance to assume for all Gaussian components.</p></li>
<li><p><strong>init_strategy</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'kmeans'</span></code>)) – The strategy for initializing component means and covariances.</p></li>
<li><p><strong>init_means</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – An optional initial guess for the means of the components. If provided,
must be a tensor of shape <code class="docutils literal notranslate"><span class="pre">[num_components,</span> <span class="pre">num_features]</span></code>. If this is given,
the <code class="docutils literal notranslate"><span class="pre">init_strategy</span></code> is ignored and the means are handled as if K-means
initialization has been run.</p></li>
<li><p><strong>convergence_tolerance</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">0.001</span></code>)) – The change in the per-datapoint negative log-likelihood which
implies that training has converged.</p></li>
<li><p><strong>covariance_regularization</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">1e-06</span></code>)) – A small value which is added to the diagonal of the
covariance matrix to ensure that it is positive semi-definite.</p></li>
<li><p><strong>batch_size</strong> (<em>The batch size to use when fitting the model. If not provided</em><em>, </em><em>the full</em>) – data will be used as a single batch. Set this if the full data does not fit into
memory.</p></li>
<li><p><strong>trainer_params</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Initialization parameters to use when initializing a PyTorch Lightning
trainer. By default, it disables various stdout logs unless TorchGMM is configured to
do verbose logging. Checkpointing and logging are disabled regardless of the log
level. This estimator further sets the following overridable defaults:
- <code class="docutils literal notranslate"><span class="pre">max_epochs=100</span></code>.</p></li>
<li><p><strong>random_state</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)) – Initialization seed.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span> <span class="o">=</span> <span class="n">anndata</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="n">path_to_anndata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sq</span><span class="o">.</span><span class="n">gr</span><span class="o">.</span><span class="n">spatial_neighbors</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">coord_type</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">,</span> <span class="n">delaunay</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cc</span><span class="o">.</span><span class="n">gr</span><span class="o">.</span><span class="n">remove_long_links</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cc</span><span class="o">.</span><span class="n">gr</span><span class="o">.</span><span class="n">aggregate_neighbors</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">Cluster</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">use_rep</span><span class="o">=</span><span class="s1">&#39;X_cellcharter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<section id="attributes-table">
<h2>Attributes table<a class="headerlink" href="#attributes-table" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.persistent_attributes" title="B_HIT.st.tl.Cluster.persistent_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">persistent_attributes</span></code></a></p></td>
<td><p>Returns the list of fitted attributes that ought to be saved and loaded.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.model_" title="B_HIT.st.tl.Cluster.model_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model_</span></code></a></p></td>
<td><p>The fitted PyTorch module with all estimated parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.converged_" title="B_HIT.st.tl.Cluster.converged_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">converged_</span></code></a></p></td>
<td><p>A boolean indicating whether the model converged during training.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.num_iter_" title="B_HIT.st.tl.Cluster.num_iter_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_iter_</span></code></a></p></td>
<td><p>The number of iterations the model was fitted for, excluding initialization.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.nll_" title="B_HIT.st.tl.Cluster.nll_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nll_</span></code></a></p></td>
<td><p>The average per-datapoint negative log-likelihood at the last training step.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="methods-table">
<h2>Methods table<a class="headerlink" href="#methods-table" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.clone" title="B_HIT.st.tl.Cluster.clone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clone</span></code></a>()</p></td>
<td><p>Clones the estimator without copying any fitted attributes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.fit" title="B_HIT.st.tl.Cluster.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(adata[, use_rep])</p></td>
<td><p>Fit data into <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> clusters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.fit_predict" title="B_HIT.st.tl.Cluster.fit_predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_predict</span></code></a>(data)</p></td>
<td><p>Fits the estimator using the provided data and subsequently predicts the labels for the data using the fitted estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.get_params" title="B_HIT.st.tl.Cluster.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</p></td>
<td><p>Returns the estimator's parameters as passed to the initializer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.load" title="B_HIT.st.tl.Cluster.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(path)</p></td>
<td><p>Loads the estimator and (if available) the fitted model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.load_attributes" title="B_HIT.st.tl.Cluster.load_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_attributes</span></code></a>(path)</p></td>
<td><p>Loads the fitted attributes that are stored at the fitted path.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.load_parameters" title="B_HIT.st.tl.Cluster.load_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_parameters</span></code></a>(path)</p></td>
<td><p>Initializes this estimator by loading its parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.predict" title="B_HIT.st.tl.Cluster.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(adata[, use_rep, store_labels, ...])</p></td>
<td><p>Predict the labels for the data in <code class="docutils literal notranslate"><span class="pre">use_rep</span></code> using the fitted model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.predict_proba" title="B_HIT.st.tl.Cluster.predict_proba"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_proba</span></code></a>(data)</p></td>
<td><p>Computes a distribution over the components for each of the provided datapoints.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.sample" title="B_HIT.st.tl.Cluster.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a>(num_datapoints)</p></td>
<td><p>Samples datapoints from the fitted Gaussian mixture.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.save" title="B_HIT.st.tl.Cluster.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(path)</p></td>
<td><p>Saves the estimator to the provided directory.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.save_attributes" title="B_HIT.st.tl.Cluster.save_attributes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_attributes</span></code></a>(path)</p></td>
<td><p>Saves the fitted attributes of this estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.save_parameters" title="B_HIT.st.tl.Cluster.save_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_parameters</span></code></a>(path)</p></td>
<td><p>Saves the parameters of this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.score" title="B_HIT.st.tl.Cluster.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(adata[, use_rep])</p></td>
<td><p>Fit data into <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> clusters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.score_samples" title="B_HIT.st.tl.Cluster.score_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_samples</span></code></a>(data)</p></td>
<td><p>Computes the negative log-likelihood (NLL) of each of the provided datapoints.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.set_params" title="B_HIT.st.tl.Cluster.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(values)</p></td>
<td><p>Sets the provided values on the estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#B_HIT.st.tl.Cluster.trainer" title="B_HIT.st.tl.Cluster.trainer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainer</span></code></a>(**kwargs)</p></td>
<td><p>Returns the trainer as configured by the estimator.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.persistent_attributes">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">persistent_attributes</span></span><a class="headerlink" href="#B_HIT.st.tl.Cluster.persistent_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Returns the list of fitted attributes that ought to be saved and loaded.</p>
<p>By default, this encompasses all annotations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.model_">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">model_</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianMixtureModel</span></code></em><a class="headerlink" href="#B_HIT.st.tl.Cluster.model_" title="Link to this definition">¶</a></dt>
<dd><p>The fitted PyTorch module with all estimated parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.converged_">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">converged_</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></em><a class="headerlink" href="#B_HIT.st.tl.Cluster.converged_" title="Link to this definition">¶</a></dt>
<dd><p>A boolean indicating whether the model converged during training.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.num_iter_">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">num_iter_</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#B_HIT.st.tl.Cluster.num_iter_" title="Link to this definition">¶</a></dt>
<dd><p>The number of iterations the model was fitted for, excluding initialization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.nll_">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">nll_</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></em><a class="headerlink" href="#B_HIT.st.tl.Cluster.nll_" title="Link to this definition">¶</a></dt>
<dd><p>The average per-datapoint negative log-likelihood at the last training step.</p>
</dd></dl>

</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Link to this heading">¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.clone">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.clone" title="Link to this definition">¶</a></dt>
<dd><p>Clones the estimator without copying any fitted attributes. All parameters of this
estimator are copied via <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy.deepcopy()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">E</span></code>, bound= BaseEstimator)</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cloned estimator with the same parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.fit">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X_cellcharter'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fit data into <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData" title="(in anndata v0.11.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnnData</span></code></a></span>) – Annotated data object.</p></li>
<li><p><strong>use_rep</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'X_cellcharter'</span></code>)) – Key in <a class="reference external" href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.obsm.html#anndata.AnnData.obsm" title="(in anndata v0.11.3)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">anndata.AnnData.obsm</span></code></a> to use as data to fit the clustering model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.fit_predict">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.fit_predict" title="Link to this definition">¶</a></dt>
<dd><p>Fits the estimator using the provided data and subsequently predicts the labels for the
data using the fitted estimator. It simply chains calls to <a class="reference internal" href="#B_HIT.st.tl.Cluster.fit" title="B_HIT.st.tl.Cluster.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> and
<a class="reference internal" href="#B_HIT.st.tl.Cluster.predict" title="B_HIT.st.tl.Cluster.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></a>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data: The data to use for fitting and to predict labels for. The data must have the</dt><dd><p>same type as for the <a class="reference internal" href="#B_HIT.st.tl.Cluster.fit" title="B_HIT.st.tl.Cluster.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> method.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">R_co</span></code>, covariant=True)</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted labels. Consult the <a class="reference internal" href="#B_HIT.st.tl.Cluster.predict" title="B_HIT.st.tl.Cluster.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></a> documentation for more information
on the return type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.get_params">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.get_params" title="Link to this definition">¶</a></dt>
<dd><p>Returns the estimator’s parameters as passed to the initializer.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>deep: Ignored. For Scikit-learn compatibility.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mapping from init parameters to values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.load" title="Link to this definition">¶</a></dt>
<dd><p>Loads the estimator and (if available) the fitted model. This method should only be
expected to work to load an estimator that has previously been saved via <a class="reference internal" href="#B_HIT.st.tl.Cluster.save" title="B_HIT.st.tl.Cluster.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>path: The directory from which to load the estimator.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">E</span></code>, bound= BaseEstimator)</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded estimator, either fitted or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.load_attributes">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">load_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.load_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Loads the fitted attributes that are stored at the fitted path. If subclasses overwrite
<a class="reference internal" href="#B_HIT.st.tl.Cluster.save_attributes" title="B_HIT.st.tl.Cluster.save_attributes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_attributes()</span></code></a>, this method should also be overwritten.</p>
<p>Typically, this method should not be called directly. It is called as part of <a class="reference internal" href="#B_HIT.st.tl.Cluster.load" title="B_HIT.st.tl.Cluster.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>path: The directory from which the parameters should be loaded.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the no fitted attributes have been stored.:</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.load_parameters">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">load_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.load_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Initializes this estimator by loading its parameters. If subclasses overwrite
<a class="reference internal" href="#B_HIT.st.tl.Cluster.save_parameters" title="B_HIT.st.tl.Cluster.save_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_parameters()</span></code></a>, this method should also be overwritten.</p>
<p>Typically, this method should not be called directly. It is called as part of <a class="reference internal" href="#B_HIT.st.tl.Cluster.load" title="B_HIT.st.tl.Cluster.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">E</span></code>, bound= BaseEstimator)</span></p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>path: The directory from which the parameters should be loaded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.predict">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X_cellcharter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'predicted_labels'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predict the labels for the data in <code class="docutils literal notranslate"><span class="pre">use_rep</span></code> using the fitted model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://anndata.readthedocs.io/en/stable/generated/anndata.AnnData.html#anndata.AnnData" title="(in anndata v0.11.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnnData</span></code></a></span>) – AnnData object containing the data to predict.</p></li>
<li><p><strong>use_rep</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'X_cellcharter'</span></code>)) – str, the name of the key to use from <code class="docutils literal notranslate"><span class="pre">adata.obsm</span></code> or <code class="docutils literal notranslate"><span class="pre">adata.X</span></code> (default is ‘X_cellcharter’).</p></li>
<li><p><strong>store_labels</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)) – bool, whether to store the predicted labels in <code class="docutils literal notranslate"><span class="pre">adata.obs</span></code> (default is False).</p></li>
<li><p><strong>store_column</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'predicted_labels'</span></code>)) – str, the name of the column to store the predicted labels (default is ‘predicted_labels’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas Categorical object containing the predicted labels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.predict_proba">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.predict_proba" title="Link to this definition">¶</a></dt>
<dd><p>Computes a distribution over the components for each of the provided datapoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float32</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span>) – The datapoints for which to compute the component assignment probabilities.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor of shape <code class="docutils literal notranslate"><span class="pre">[num_datapoints,</span> <span class="pre">num_components]</span></code> with the assignment
probabilities for each component and datapoint. Note that each row of the vector sums
to 1, i.e. the returned tensor provides a proper distribution over the components for
each datapoint.</p>
</dd>
</dl>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>When calling this function in a multi-process environment, each process receives only
a subset of the predictions. If you want to aggregate predictions, make sure to gather
the values returned from this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.sample">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_datapoints</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.sample" title="Link to this definition">¶</a></dt>
<dd><p>Samples datapoints from the fitted Gaussian mixture.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>num_datapoints: The number of datapoints to sample.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tensor of shape <code class="docutils literal notranslate"><span class="pre">[num_datapoints,</span> <span class="pre">dim]</span></code> providing the samples.</p>
<dl class="simple">
<dt>Note:</dt><dd><p>This method does not parallelize across multiple processes, i.e. performs no
synchronization.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.save">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.save" title="Link to this definition">¶</a></dt>
<dd><p>Saves the estimator to the provided directory. It saves a file named
<code class="docutils literal notranslate"><span class="pre">estimator.pickle</span></code> for the configuration of the estimator and
additional files for the fitted model (if applicable). For more
information on the files saved for the fitted model or for more
customization, look at <a class="reference internal" href="#B_HIT.st.tl.Cluster.get_params" title="B_HIT.st.tl.Cluster.get_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_params()</span></code></a> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">torchgmm.base.nn.Configurable.save()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>path: The directory to which all files should be saved.</p>
</dd>
<dt>Note:</dt><dd><p>This method may be called regardless of whether the estimator has already been fitted.</p>
</dd>
<dt>Attention:</dt><dd><p>If the dictionary returned by <a class="reference internal" href="#B_HIT.st.tl.Cluster.get_params" title="B_HIT.st.tl.Cluster.get_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_params()</span></code></a> is not JSON-serializable, this method
uses <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a> which is not necessarily backwards-compatible.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.save_attributes">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">save_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.save_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Saves the fitted attributes of this estimator. By default, it uses JSON and falls back to
<a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>. Subclasses should overwrite this method if non-primitive attributes are
fitted.</p>
<p>Typically, this method should not be called directly. It is called as part of <a class="reference internal" href="#B_HIT.st.tl.Cluster.save" title="B_HIT.st.tl.Cluster.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>path: The directory to which the fitted attributed should be saved.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotFittedError</strong> – If the estimator has not been fitted.:</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.save_parameters">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">save_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.save_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Saves the parameters of this estimator. By default, it uses JSON and falls back to
<a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>. It subclasses use non-primitive types as parameters, they should overwrite
this method.</p>
<p>Typically, this method should not be called directly. It is called as part of <a class="reference internal" href="#B_HIT.st.tl.Cluster.save" title="B_HIT.st.tl.Cluster.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>path: The directory to which the parameters should be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.score">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X_cellcharter'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.score" title="Link to this definition">¶</a></dt>
<dd><p>Fit data into <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> clusters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.score_samples">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">score_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.score_samples" title="Link to this definition">¶</a></dt>
<dd><p>Computes the negative log-likelihood (NLL) of each of the provided datapoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float32</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span>) – The datapoints for which to compute the NLL.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor of shape <code class="docutils literal notranslate"><span class="pre">[num_datapoints]</span></code> with the NLL for each datapoint.</p>
</dd>
</dl>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>When calling this function in a multi-process environment, each process receives only
a subset of the predictions. If you want to aggregate predictions, make sure to gather
the values returned from this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.set_params">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.set_params" title="Link to this definition">¶</a></dt>
<dd><p>Sets the provided values on the estimator. The estimator is returned as well, but the
estimator on which this function is called is also modified.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>values: The values to set.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">E</span></code>, bound= BaseEstimator)</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The estimator where the values have been set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="B_HIT.st.tl.Cluster.trainer">
<span class="sig-prename descclassname"><span class="pre">Cluster.</span></span><span class="sig-name descname"><span class="pre">trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#B_HIT.st.tl.Cluster.trainer" title="Link to this definition">¶</a></dt>
<dd><p>Returns the trainer as configured by the estimator. Typically, this method is only called
by functions in the estimator.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>kwargs: Additional arguments that override the trainer arguments registered in the</dt><dd><p>initializer of the estimator.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A fully initialized PyTorch Lightning trainer.</p>
<dl class="simple">
<dt>Note:</dt><dd><p>This function should be preferred over initializing the trainer directly. It ensures
that the returned trainer correctly deals with TorchGMM components that may be
introduced in the future.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="B_HIT.st.tl.ClusterAutoK.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">B_HIT.st.tl.ClusterAutoK</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="B_HIT.st.tl.dbscan_filter.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">B_HIT.st.tl.dbscan_filter</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Zeng lab.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">B_HIT.st.tl.Cluster</a><ul>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster"><code class="docutils literal notranslate"><span class="pre">Cluster</span></code></a></li>
<li><a class="reference internal" href="#attributes-table">Attributes table</a></li>
<li><a class="reference internal" href="#methods-table">Methods table</a></li>
<li><a class="reference internal" href="#attributes">Attributes</a><ul>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.persistent_attributes"><code class="docutils literal notranslate"><span class="pre">Cluster.persistent_attributes</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.model_"><code class="docutils literal notranslate"><span class="pre">Cluster.model_</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.converged_"><code class="docutils literal notranslate"><span class="pre">Cluster.converged_</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.num_iter_"><code class="docutils literal notranslate"><span class="pre">Cluster.num_iter_</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.nll_"><code class="docutils literal notranslate"><span class="pre">Cluster.nll_</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.clone"><code class="docutils literal notranslate"><span class="pre">Cluster.clone()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.fit"><code class="docutils literal notranslate"><span class="pre">Cluster.fit()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.fit_predict"><code class="docutils literal notranslate"><span class="pre">Cluster.fit_predict()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.get_params"><code class="docutils literal notranslate"><span class="pre">Cluster.get_params()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.load"><code class="docutils literal notranslate"><span class="pre">Cluster.load()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.load_attributes"><code class="docutils literal notranslate"><span class="pre">Cluster.load_attributes()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.load_parameters"><code class="docutils literal notranslate"><span class="pre">Cluster.load_parameters()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.predict"><code class="docutils literal notranslate"><span class="pre">Cluster.predict()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.predict_proba"><code class="docutils literal notranslate"><span class="pre">Cluster.predict_proba()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.sample"><code class="docutils literal notranslate"><span class="pre">Cluster.sample()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.save"><code class="docutils literal notranslate"><span class="pre">Cluster.save()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.save_attributes"><code class="docutils literal notranslate"><span class="pre">Cluster.save_attributes()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.save_parameters"><code class="docutils literal notranslate"><span class="pre">Cluster.save_parameters()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.score"><code class="docutils literal notranslate"><span class="pre">Cluster.score()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.score_samples"><code class="docutils literal notranslate"><span class="pre">Cluster.score_samples()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.set_params"><code class="docutils literal notranslate"><span class="pre">Cluster.set_params()</span></code></a></li>
<li><a class="reference internal" href="#B_HIT.st.tl.Cluster.trainer"><code class="docutils literal notranslate"><span class="pre">Cluster.trainer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=c1cae59a"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>